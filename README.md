# protoc-gen-parquet

A protoc plugin that generates parquet schemas from protobuf files. See [examples](./examples).

Parquet specs underwent different changes over time, we're trying to generate schemas consistent with the ones generated by Apache Spark >2.0.x.
See [timestamps](#Hive-Timestamps) for instance.

## Installation

```bash
go get github.com/simo7/protoc-gen-parquet
```

Alternatively clone the repo and build the plugin:

```bash
go build -o bin/protoc-gen-parquet .

export PATH=$PWD/bin:$PATH
```

## Usage

```bash
protoc \
    --parquet_out=no_unsigned=true:./ \
    --parquet_opt=paths=source_relative \
    examples/person.proto
```

## Hive Timestamps

Fields extended as timestamps using [hive options](https://github.com/simo7/protoc-gen-gluecatalog/hive_options)
are generated as `INT96` fields to ensure compatibility with Hive and Presto.

## Parquet Annotations

The following annotations are *not* implemented.

- `(TIMESTAMP(MILLIS, true))`, `(TIMESTAMP(MICROS, true))`, `(TIMESTAMP(NANOS, true))`
- `(DATE)`
- `(UUID)`
- `(MAP)`, `(MAP_KEY_VALUE)`
- `(STRING)`  (all UTF8 by default)

## Compatibility

It's tested against the new protobuf API `google.golang.org/protobuf` or version `1.4.0` of the legacy API `github.com/golang/protobuf`.
